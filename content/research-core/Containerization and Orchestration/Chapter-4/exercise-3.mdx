---
title: "Exercise 3: Disk Management - Managing Advanced Storage"
description: Here are some key issues pertaining to Managing Advanced Storage that have been addressed and are crucial for exam preparation.
date: "2024-04-02"
parent: "Chapter 4: Configure local storage"
grand_parent : "Redhat Enterprise Linux 9 - EX200 RHCSA"
order: 8
completed: true
---

## Managing Advanced Storage

### Create a Stratis pool named pisstratispool using the disk /dev/nvme0n5.

```bash {2,26} /pisstratispool/2
# Creating the stratis pool 
[root@server ~]# stratis pool create pisstratispool /dev/nvme0n5

# Listing the stratis pool
[root@server ~]# stratis pool list 
Name                    Total / Used / Free    Properties                                   UUID   Alerts
pisstratispool   5 GiB / 526 MiB / 4.49 GiB   ~Ca,~Cr, Op   e90237bc-e62d-46d5-9001-618b9dc6ff8e   WS001 

[root@server ~]# lsblk 
NAME                                                                    MAJ:MIN RM  SIZE RO TYPE    MOUNTPOINTS
sr0                                                                      11:0    1 1024M  0 rom     
nvme0n1                                                                 259:0    0   20G  0 disk    
├─nvme0n1p1                                                             259:1    0  600M  0 part    /boot/efi
├─nvme0n1p2                                                             259:2    0    1G  0 part    /boot
└─nvme0n1p3                                                             259:3    0 18.4G  0 part    
  ├─cs-root                                                             253:0    0 16.4G  0 lvm     /
  └─cs-swap                                                             253:1    0    2G  0 lvm     [SWAP]
nvme0n2                                                                 259:4    0    5G  0 disk    
├─nvme0n2p1                                                             259:5    0    1G  0 part    /pisdata1
└─nvme0n2p2                                                             259:6    0  512M  0 part    [SWAP]
nvme0n3                                                                 259:7    0    6G  0 disk    
└─nvme0n3p1                                                             259:8    0    1G  0 part    
  ├─pisvg-pislv1                                                        253:2    0  200M  0 lvm     /pisdata3
  └─pisvg-pislv2                                                        253:3    0  1.3G  0 lvm     
nvme0n4                                                                 259:9    0    5G  0 disk    
└─pisvg-pislv2                                                          253:3    0  1.3G  0 lvm     
nvme0n5                                                                 259:10   0    5G  0 disk    
└─stratis-1-private-e90237bce62d46d59001618b9dc6ff8e-physical-originsub 253:4    0    5G  0 stratis 
  ├─stratis-1-private-e90237bce62d46d59001618b9dc6ff8e-flex-thinmeta    253:5    0    5M  0 stratis 
  │ └─stratis-1-private-e90237bce62d46d59001618b9dc6ff8e-thinpool-pool  253:8    0  4.5G  0 stratis 
  ├─stratis-1-private-e90237bce62d46d59001618b9dc6ff8e-flex-thindata    253:6    0  4.5G  0 stratis 
  │ └─stratis-1-private-e90237bce62d46d59001618b9dc6ff8e-thinpool-pool  253:8    0  4.5G  0 stratis 
  └─stratis-1-private-e90237bce62d46d59001618b9dc6ff8e-flex-mdv         253:7    0  512M  0 stratis 
nvme0n6                                                                 259:11   0    2G  0 disk  

```

### Expand capacity of the pisstratispool using the another disk /dev/nvme0n6.

```bash /7 GiB/
[root@server ~]# stratis pool add-data pisstratispool /dev/nvme0n6 

[root@server ~]# stratis pool list 
Name                    Total / Used / Free    Properties                                   UUID   Alerts
pisstratispool   7 GiB / 530 MiB / 6.48 GiB   ~Ca,~Cr, Op   e90237bc-e62d-46d5-9001-618b9dc6ff8e         
```

### Create a thin provisioned filesystem named pispoolfs in the pisstratispool

```bash
[root@server ~]# stratis fs create pisstratispool pispoolfs

[root@server ~]# stratis fs list 
Pool             Filesystem   Total / Used / Free / Limit            Created             Device                                  UUID                                
pisstratispool   pispoolfs    1 TiB / 546 MiB / 1023.47 GiB / None   Apr 16 2024 16:02   /dev/stratis/pisstratispool/pispoolfs   cfbebc79-8c84-4955-9111-fed84d3d56bb
```

### Mount the pispoolfs filesystem on /pisdir4 directory and also make sure that it gets mounts automatically at boot time.

```bash
# Temporary Mounting
[root@server /]# mount /dev/stratis/pisstratispool/pispoolfs /pisdir4 
[root@server /]# df -h 
Filesystem                                                                                       Size  Used Avail Use% Mounted on
devtmpfs                                                                                         4.0M     0  4.0M   0% /dev
tmpfs                                                                                            1.8G     0  1.8G   0% /dev/shm
tmpfs                                                                                            717M  9.4M  708M   2% /run
/dev/mapper/cs-root                                                                               17G  5.2G   12G  32% /
/dev/nvme0n2p1                                                                                   960M   39M  922M   5% /pisdata1
/dev/mapper/pisvg-pislv1                                                                         195M   12M  184M   6% /pisdata3
/dev/nvme0n1p2                                                                                   960M  481M  480M  51% /boot
/dev/nvme0n1p1                                                                                   599M  7.0M  592M   2% /boot/efi
tmpfs                                                                                            1.0M     0  1.0M   0% /run/stratisd/ns_mounts
tmpfs                                                                                            359M  100K  359M   1% /run/user/1000
/dev/mapper/stratis-1-e90237bce62d46d59001618b9dc6ff8e-thin-fs-cfbebc798c8449559111fed84d3d56bb  1.0T  7.2G 1017G   1% /pisdir4


# Permanent Mounting
[root@server ~]# vim /etc/fstab 
[root@server ~]# tail -1 /etc/fstab 
/dev/stratis/pisstratispool/pispoolfs			/pisdir4	xfs 	defaults,x-systemd.requires=stratisd.service 	0	 0

# Daemon Reload
[root@server ~]# mount -a 
mount: (hint) your fstab has been modified, but systemd still uses
       the old version; use 'systemctl daemon-reload' to reload.
[root@server ~]# systemctl daemon-reload

# After Reboot
[root@server ~]# df -h 
Filesystem                                                                                       Size  Used Avail Use% Mounted on
devtmpfs                                                                                         4.0M     0  4.0M   0% /dev
tmpfs                                                                                            1.8G     0  1.8G   0% /dev/shm
tmpfs                                                                                            717M  9.4M  708M   2% /run
/dev/mapper/cs-root                                                                               17G  5.2G   12G  32% /
/dev/mapper/pisvg-pislv1                                                                         195M   12M  184M   6% /pisdata3
/dev/nvme0n2p1                                                                                   960M   39M  922M   5% /pisdata1
tmpfs                                                                                            1.0M     0  1.0M   0% /run/stratisd/ns_mounts
/dev/nvme0n1p2                                                                                   960M  481M  480M  51% /boot
/dev/nvme0n1p1                                                                                   599M  7.0M  592M   2% /boot/efi
tmpfs                                                                                            359M   16K  359M   1% /run/user/42
/dev/mapper/stratis-1-e90237bce62d46d59001618b9dc6ff8e-thin-fs-cfbebc798c8449559111fed84d3d56bb  1.0T  7.2G 1017G   1% /pisdir4
tmpfs                                                                                            359M   96K  359M   1% /run/user/1000
```
